
{% block grid %}
    {% csrf_token %}
    <script type="text/javascript">
    
    $(document).ready(function() {
        var dtable = $('#exptable').DataTable( {
            processing: true,
            serverSide: false,
            select:     true,
            ajax: {
                url: "{% url 'scxrd:order_list_json' %}",
                type: "POST",
                headers: { "X-CSRFToken": '{{csrf_token}}', 
                            'CSRFToken': '{{csrf_token}}'
                        },
            },
            stateSave: false,
            paging: false,
            scrollY: 350,    // This defines the height of the table!
            columns: [
                { visible: false, 
                  searchable: false,},
                { title: "Number", 
                  searchable: false,},
                { title: "Experiment" },
                { title: "Date", 
                  searchable: false,
                  render: function(d) {
                  return moment(d).format("DD:MM:YYYY, HH:mm");
                  }
                },
                { title: "Machine" },
                //{ title: "cif"},
                {
                mRender: function(data, type, full) {
                return '<a class="badge badge-danger" href=edit/' + full[0] + '>' + 'Edit' + '</a>';
                    }
                },
            ],

            //"lengthMenu": [[2, 25, 50, -1], [2, 25, 50, "All"]],
            // No extra menus:
            //dom: '<"top"i><"clear">',
        });
     
        var data;
        var urldata;
        dtable.on('click', 'tr', function () {
            data = dtable.row( this ).data();
            //alert( 'You clicked on '+ data[0]+'\'s row' );
            //console.log(data);
            urldata = 'table/'+data[0];
            //console.log(urldata);
            //get_ttable(urldata);
            $.get(url = urldata, function (result) {
                console.log(result);
                document.getElementById("ttable").innerHTML = result;
            });
        } );
    
    
    
    });
        
    </script>
{% endblock grid %}